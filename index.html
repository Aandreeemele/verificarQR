<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Esc√°ner de C√≥digo QR</title>

<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body{
font-family:"Segoe UI",Arial;
text-align:center;
background:#000;
color:white;
padding:20px;
}

#reader{
width:100%;
max-width:380px;
margin:auto;
display:none;
border:2px solid #00bcd4;
border-radius:12px;
}

#result{
background:#1a1a1a;
padding:15px;
border-radius:10px;
max-width:380px;
margin:auto;
text-align:left;
}

.campo{
margin:6px 0;
border-bottom:1px solid #333;
padding-bottom:4px;
}

.accion-btn{
margin-top:10px;
background:#25D366;
color:black;
padding:8px 12px;
border-radius:8px;
text-decoration:none;
display:inline-block;
font-weight:600;
}

button{
margin-top:20px;
background:#00bcd4;
border:none;
padding:12px;
border-radius:8px;
width:90%;
max-width:380px;
font-weight:bold;
}
</style>
</head>

<body>

<h2>üì∑ Esc√°ner de C√≥digo QR</h2>

<div id="reader"></div>
<div id="result">Esperando escaneo...</div>

<button id="scanButton">Iniciar escaneo</button>

<script>

let html5QrCode;

async function startScanner(){

document.getElementById("reader").style.display="block";
document.getElementById("scanButton").style.display="none";

html5QrCode=new Html5Qrcode("reader");

await html5QrCode.start(
{facingMode:"environment"},
{fps:10,qrbox:{width:250,height:250}},
onScanSuccess
);
}

async function onScanSuccess(decodedText){

await html5QrCode.stop();

document.getElementById("reader").style.display="none";
document.getElementById("scanButton").style.display="inline-block";
document.getElementById("scanButton").innerText="üì∑ Escanear otro c√≥digo";

let texto=decodedText.replace(/\\n/g,"\n");
let lineas=texto.split("\n").filter(l=>l.trim()!="");

let html=`<h3>‚úÖ C√≥digo detectado correctamente</h3>`;

let numero="";
let correo="";
let nombre="";
let apellido="";
let turno="";
let contrase√±a="";

lineas.forEach(linea=>{

let partes=linea.split(":");

if(partes.length===2){

let claveOriginal=partes[0].trim();
let clave=claveOriginal.toLowerCase();
let valor=partes[1].trim();

html+=`<div class="campo"><strong>${claveOriginal}:</strong> ${valor}</div>`;

if(clave.includes("tel")||clave.includes("numero")||clave.includes("whatsapp"))
numero=valor;

if(clave.includes("correo")||clave.includes("email"))
correo=valor;

if(clave.includes("nombre"))
nombre=valor;

if(clave.includes("apellido"))
apellido=valor;

if(clave.includes("turno"))
turno=valor;

if(clave.includes("contrase√±a"))
contrase√±a=valor;

}
});


// ================= WHATSAPP =================
if(numero){

const mensajeWhatsApp=encodeURIComponent(
`Estimado(a) *${nombre} ${apellido}*,

La Hermandad Virgen de la Soledad Mixco confirma su registro de pre-inscripci√≥n correctamente para nuestras actividades de *Semana Santa 2026*, recuerde los siguientes datos:

Turno asignado: *${turno}*
Contrase√±a: *${contrase√±a}*

Importante tomar en consideraci√≥n las recomendaciones:
Para pago y entrega de Cartulina estaremos ubicados en el atrio de la Parroquia Santo Domingo de Guzm√°n todos los domingos de Cuaresma de 7:00 am a 1:00 pm. Quinto Domingo y Domingo de Ramos de 7:00 am a 5:00 pm.
Es importante presentar su C√≥digo QR o DPI para la entrega de la Cartulina.

#500a√±osDeConocerAJes√∫s
Hermandad Virgen de la Soledad Mixco`
);

const uniformeHombre=encodeURIComponent(
`Estimada hermana *${nombre} ${apellido}*,

Agradecemos la adquisici√≥n de su turno llevar en hombros a Nuestra Madre Sant√≠sima en esta *Semana Santa 2026:* *${turno}*.

*Uniformidad:*
Camisa color blanco, traje completo oscuro, guantes, corbata y zapatos color negro. *NO UTILIZAR tenis, celulares y lentes oscuros en filas.*

*A LOS HERMANOS CARGADORES*
Se les solicita presentarse con la uniformidad indicada anteriormente. Recuerde que, al momento de adquirir su turno, acepto la normativa de la uniformidad y comportamiento dictados por la Hermandad. *Por lo que de no ser acatadas las mismas nos reservamos su participaci√≥n.*

Madre Sant√≠sima, de rodillas ante ti, te pedimos nos consigas de nuestro Padre Celestial el perd√≥n de nuestros pecados, por mediaci√≥n de tu Hijo Jesucristo.

*500 a√±os de Conocer a Jes√∫s.*

*Sant√≠sima Virgen de Dolores Ruega por nosotros*
*Sant√≠sima Virgen de Soledad Ruega por nosotros*`
);

const uniformeMujer=encodeURIComponent(
`Estimada hermana *${nombre} ${apellido}*,

Agradecemos la adquisici√≥n de su turno llevar en hombros a Nuestra Madre Sant√≠sima en esta *Semana Santa 2026:* *${turno}*.

*Uniformidad:*
Vestido o conjunto de falda y blusa negra, con mangas y sin escote pronunciado, la falda debe de ser debajo de la rodilla y sin abertura pronunciada, mantilla o madrile√±a, medias y zapatos negros. Si utiliza traje t√≠pico, debe ser de luto y acompa√±ado de su√©ter negro. *NO UTILIZAR brillantes, tenis, celulares y lentes oscuros en filas.*

*A LAS HERMANAS CARGADORAS*
Se les solicita presentarse con la uniformidad indicada anteriormente. Recuerde que, al momento de adquirir su turno, acepto la normativa de la uniformidad y comportamiento dictados por la Hermandad. Por lo que de no ser acatadas las mismas nos reservamos el derecho de su participaci√≥n.

Madre Sant√≠sima, de rodillas ante ti, te pedimos nos consigas de nuestro Padre Celestial el perd√≥n de nuestros pecados, por mediaci√≥n de tu Hijo Jesucristo.

*500 a√±os de Conocer a Jes√∫s.*

*Sant√≠sima Virgen de Dolores Ruega por nosotros*
*Sant√≠sima Virgen de Soledad Ruega por nosotros*`
);

html+=`
<a class="accion-btn" target="_blank"
href="https://wa.me/${numero}?text=${mensajeWhatsApp}">
üì± WhatsApp Confirmaci√≥n
</a>`;

html+=`
<a class="accion-btn" target="_blank"
href="https://wa.me/${numero}?text=${uniformeHombre}">
üëï Uniforme Hombre
</a>`;

html+=`
<a class="accion-btn" target="_blank"
href="https://wa.me/${numero}?text=${uniformeMujer}">
üëó Uniforme Mujer
</a>`;
}


// ================= CORREO =================
if(correo){

const asunto=encodeURIComponent("Registro Confirmado");
const cuerpo=encodeURIComponent(
`Estimado(a) *${nombre} ${apellido}*,

La Hermandad Virgen de la Soledad Mixco confirma su registro de pre-inscripci√≥n correctamente para nuestras actividades de *Semana Santa 2026*, recuerde los siguientes datos:

Turno asignado: *${turno}*
Contrase√±a: *${contrase√±a}*

Importante tomar en consideraci√≥n las recomendaciones:
Para pago y entrega de Cartulina estaremos ubicados en el atrio de la Parroquia Santo Domingo de Guzm√°n todos los domingos de Cuaresma de 7:00 am a 1:00 pm. Quinto Domingo y Domingo de Ramos de 7:00 am a 5:00 pm.
Es importante presentar su C√≥digo QR o DPI para la entrega de la Cartulina.

#500a√±osDeConocerAJes√∫s
Hermandad Virgen de la Soledad Mixco`
);

html+=`
<a class="accion-btn"
href="mailto:${correo}?subject=${asunto}&body=${cuerpo}">
üìß Enviar correo
</a>`;
}

document.getElementById("result").innerHTML=html;
}

document.getElementById("scanButton")
.addEventListener("click",startScanner);

</script>

</body>
</html>